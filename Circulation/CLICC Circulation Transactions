--RR-363
SELECT DISTINCT
it.item_type_name,
p.INSTITUTION_ID,
pg.PATRON_GROUP_DISPLAY,
psc.PATRON_STAT_code,
mi.ITEM_ENUM,
to_char(ct.charge_date, 'fmMM/DD/YYYY HH:fmMI AM') AS charge_date,
--To_Char (ct.charge_date,'fmMM/ DD/ YYYY') AS charge_date,
l.location_name AS CHARGE_PLACE,
to_char(ct.discharge_date, 'fmMM/DD/YYYY HH:fmMI AM') AS discharge_date,
--To_Char (ct.discharge_date,'fmMM/ DD/ YYYY') AS discharge_date,
l.location_name AS DISCHARGE_PLACE

FROM ucla_BIBTEXT_vw bt

INNER join BIB_MFHD bmf ON bt.BIB_ID = bmf.BIB_ID
INNER join MFHD_MASTER mm ON bmf.MFHD_ID = mm.MFHD_ID
left outer join LOCATION l ON mm.LOCATION_ID = l.LOCATION_ID
left outer join MFHD_ITEM mi ON mm.MFHD_ID = mi.MFHD_ID
left outer join ITEM i ON mi.ITEM_ID = i.ITEM_ID
left outer join ITEM_TYPE it ON i.ITEM_TYPE_ID = it.ITEM_TYPE_ID
left outer join CIRC_TRANS_archive ct ON i.ITEM_ID = ct.ITEM_ID
left outer join PATRON_GROUP pg ON ct.PATRON_GROUP_ID = pg.PATRON_GROUP_ID
left outer join PATRON p ON ct.PATRON_ID = p.PATRON_ID
left outer join PATRON_STAT_CODE psc ON p.PATRON_ID = psc.PATRON_STAT_ID

WHERE         ct.charge_date BETWEEN trunc($P{startDate}) and trunc($P{endDate})
                       AND
              it.item_type_name = 'CLICC Laptop'
              OR it.item_type_name = 'CLICC Accessories'
              OR it.item_type_name = 'CLICC Media Kit'
              OR it.item_type_name = 'CLICC iPad'
              OR it.item_type_name = 'CLICC Portable Classroom'


             ORDER BY it.item_type_name


